(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{10:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var s=(i=a,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),r=a.sources.map(function(e){return"/*# sourceURL="+a.sourceRoot+e+" */"});return[n].concat(r).concat([s]).join("\n")}var i;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},s=0;s<this.length;s++){var r=this[s][0];null!=r&&(a[r]=!0)}for(s=0;s<e.length;s++){var i=e[s];null!=i[0]&&a[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),t.push(i))}},t}},105:function(e,t,n){"use strict";var a=n(0);t.a=a.default.extend({data:()=>({columns:[{field:"id"}],totalRecords:0,serverParams:{sortField:"id",sortType:"asc",page:1,perPage:10,search:""}}),created(){this.serverParams.sortField=this.columns[0].field},methods:{fetchData:()=>Promise.resolve(),onPageChange(e){this.serverParams.page=e.currentPage,this.fetchData()},onPerPageChange(e){this.serverParams.perPage=e.currentPerPage,this.fetchData()},onSortChange(e){let[t]=e;this.serverParams.sortType=t.type,this.serverParams.sortField=t.field,this.fetchData()},onSearch(e){this.serverParams.search=e.searchTerm,this.fetchData()}}})},11:function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},s=0;s<t.length;s++){var r=t[s],i=r[0],o={id:e+":"+s,css:r[1],media:r[2],sourceMap:r[3]};a[i]?a[i].parts.push(o):n.push(a[i]={id:i,parts:[o]})}return n}n.r(t),n.d(t,"default",function(){return f});var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var r={},i=s&&(document.head||document.getElementsByTagName("head")[0]),o=null,c=0,l=!1,d=function(){},u=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,n,s){l=n,u=s||{};var i=a(e,t);return h(i),function(t){for(var n=[],s=0;s<i.length;s++){var o=i[s];(c=r[o.id]).refs--,n.push(c)}t?h(i=a(e,t)):i=[];for(s=0;s<n.length;s++){var c;if(0===(c=n[s]).refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete r[c.id]}}}}function h(e){for(var t=0;t<e.length;t++){var n=e[t],a=r[n.id];if(a){a.refs++;for(var s=0;s<a.parts.length;s++)a.parts[s](n.parts[s]);for(;s<n.parts.length;s++)a.parts.push(v(n.parts[s]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var i=[];for(s=0;s<n.parts.length;s++)i.push(v(n.parts[s]));r[n.id]={id:n.id,refs:1,parts:i}}}}function g(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function v(e){var t,n,a=document.querySelector("style["+m+'~="'+e.id+'"]');if(a){if(l)return d;a.parentNode.removeChild(a)}if(p){var s=c++;a=o||(o=g()),t=$.bind(null,a,s,!1),n=$.bind(null,a,s,!0)}else a=g(),t=function(e,t){var n=t.css,a=t.media,s=t.sourceMap;a&&e.setAttribute("media",a);u.ssrId&&e.setAttribute(m,t.id);s&&(n+="\n/*# sourceURL="+s.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}var b,w=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function $(e,t,n,a){var s=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=w(t,s);else{var r=document.createTextNode(s),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(r,i[t]):e.appendChild(r)}}},148:function(e,t,n){var a=n(347);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n(11).default)("1612bb34",a,!0,{})},346:function(e,t,n){"use strict";var a=n(148);n.n(a).a},347:function(e,t,n){(e.exports=n(10)(!1)).push([e.i,".operations-menu{margin-left:-35px}.row-at-bottom{margin-top:-100px}",""])},396:function(e,t,n){"use strict";n.r(t);var a=n(90),s=(n(87),n(5)),r=n(76),i=n(105),o=n(67);function c(e,t,n,a,s,r,i){try{var o=e[r](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(a,s)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(a,s){var r=e.apply(t,n);function i(e){c(r,a,s,i,o,"next",e)}function o(e){c(r,a,s,i,o,"throw",e)}i(void 0)})}}var d={name:"UsersManagement",components:{VueGoodTable:a.a},filters:{humanizePermission(e){switch(e.permission){case-1:return Object(s.a)("admin.banned");case 0:return Object(s.a)("admin.normal");case 1:return Object(s.a)("admin.admin");case 2:return Object(s.a)("admin.superAdmin");default:return""}},playersLink:e=>"".concat(blessing.base_url,"/admin/players?uid=").concat(e.uid)},mixins:[o.a,r.a,i.a],data(){return{users:[],columns:[{field:"uid",label:"UID",type:"number"},{field:"email",label:this.$t("general.user.email")},{field:"nickname",label:this.$t("general.user.nickname"),width:"150px"},{field:"score",label:this.$t("general.user.score"),type:"number",width:"102px"},{field:"players_count",label:this.$t("admin.playersCount"),type:"number"},{field:"permission",label:this.$t("admin.permission"),globalSearchDisabled:!0},{field:"verified",label:this.$t("admin.verification"),type:"boolean",globalSearchDisabled:!0},{field:"register_at",label:this.$t("general.user.register-at")},{field:"operations",label:this.$t("admin.operationsTitle"),sortable:!1,globalSearchDisabled:!0}]}},beforeMount(){this.fetchData()},methods:{fetchData(){var e=this;return l(function*(){const{data:t,totalRecords:n}=yield e.$http.get("/admin/user-data".concat(location.search),!location.search&&e.serverParams);e.totalRecords=n,e.users=t})()},changeEmail(e){var t=this;return l(function*(){let n;try{({value:n}=yield t.$prompt(t.$t("admin.newUserEmail"),{inputValue:e.email,inputValidator:e=>!!e||t.$t("auth.emptyEmail")}))}catch(e){return}const{code:a,message:s}=yield t.$http.post("/admin/users?action=email",{uid:e.uid,email:n});0===a?(e.email=n,t.$message.success(s)):t.$message.warning(s)})()},toggleVerification(e){var t=this;return l(function*(){const{code:n,message:a}=yield t.$http.post("/admin/users?action=verification",{uid:e.uid});0===n?(e.verified=!e.verified,t.$message.success(a)):t.$message.warning(a)})()},changeNickName(e){var t=this;return l(function*(){let n;try{({value:n}=yield t.$prompt(t.$t("admin.newUserNickname"),{inputValue:e.nickname,inputValidator:e=>!!e||t.$t("auth.emptyNickname")}))}catch(e){return}const{code:a,message:s}=yield t.$http.post("/admin/users?action=nickname",{uid:e.uid,nickname:n});0===a?(e.nickname=n,t.$message.success(s)):t.$message.warning(s)})()},changePassword(e){var t=this;return l(function*(){let n;try{({value:n}=yield t.$prompt(t.$t("admin.newUserPassword"),{inputType:"password"}))}catch(e){return}const{code:a,message:s}=yield t.$http.post("/admin/users?action=password",{uid:e.uid,password:n});0===a?t.$message.success(s):t.$message.warning(s)})()},changeScore(e){var t=this;return l(function*(){let n;try{({value:n}=yield t.$prompt(t.$t("admin.newScore"),{inputType:"number",inputValue:e.score}))}catch(e){return}const a=Number.parseInt(n),{code:s,message:r}=yield t.$http.post("/admin/users?action=score",{uid:e.uid,score:a});0===s?(e.score=a,t.$message.success(r)):t.$message.warning(r)})()},changePermission(e){var t=this;return l(function*(){const n=e.operations,a=[t.$t("admin.banned"),t.$t("admin.normal")];2===n&&a.push(t.$t("admin.admin"));const s=t.$createElement,r=s("div",null,[s("span",null,t.$t("admin.newPermission")),s("select",{attrs:{selectedIndex:0}},a.map(e=>s("option",null,e)))]);try{yield t.$msgbox({message:r,showCancelButton:!0})}catch(e){return}const i=r.children[1].elm.selectedIndex-1,{code:o,message:c}=yield t.$http.post("/admin/users?action=permission",{uid:e.uid,permission:i});0===o?(e.permission=+i,t.$message.success(c)):t.$message.warning(c)})()},deleteUser(e){var t=this;return l(function*(){let{uid:n,originalIndex:a}=e;try{yield t.$confirm(t.$t("admin.deleteUserNotice"),{type:"warning"})}catch(e){return}const{code:s,message:r}=yield t.$http.post("/admin/users?action=delete",{uid:n});0===s?(t.$delete(t.users,a),t.$message.success(r)):t.$message.warning(r)})()}}},u=(n(346),n(66)),m=Object(u.a)(d,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"content"},[n("vue-good-table",{attrs:{mode:"remote",rows:e.users,"total-rows":e.totalRecords||e.users.length,columns:e.columns,"search-options":e.tableOptions.search,"pagination-options":e.tableOptions.pagination,"style-class":"vgt-table striped"},on:{"on-page-change":e.onPageChange,"on-sort-change":e.onSortChange,"on-search":e.onSearch,"on-per-page-change":e.onPerPageChange},scopedSlots:e._u([{key:"table-row",fn:function(t){return["email"===t.column.field?n("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),n("a",{attrs:{title:e.$t("admin.changeEmail"),"data-test":"email"},on:{click:function(n){return e.changeEmail(t.row)}}},[n("i",{staticClass:"fas fa-edit btn-edit"})])]):"nickname"===t.column.field?n("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),n("a",{attrs:{title:e.$t("admin.changeNickName"),"data-test":"nickname"},on:{click:function(n){return e.changeNickName(t.row)}}},[n("i",{staticClass:"fas fa-edit btn-edit"})])]):"score"===t.column.field?n("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),n("a",{attrs:{title:e.$t("admin.changeScore"),"data-test":"score"},on:{click:function(n){return e.changeScore(t.row)}}},[n("i",{staticClass:"fas fa-edit btn-edit"})])]):"players_count"===t.column.field?n("span",[n("a",{attrs:{href:e._f("playersLink")(t.row),title:e.$t("admin.inspectHisPlayers"),"data-toggle":"tooltip","data-placement":"right"}},[e._v(e._s(t.formattedRow[t.column.field]))])]):"permission"===t.column.field?n("span",[n("span",[e._v(e._s(e._f("humanizePermission")(t.row)))]),e._v(" "),t.row.permission<1||2===t.row.operations&&t.row.permission<2?n("a",{attrs:{title:e.$t("admin.changePermission"),"data-test":"permission"},on:{click:function(n){return e.changePermission(t.row)}}},[n("i",{staticClass:"fas fa-edit btn-edit"})]):e._e()]):"verified"===t.column.field?n("span",[t.row.verified?n("span",{directives:[{name:"t",rawName:"v-t",value:"admin.verified",expression:"'admin.verified'"}]}):n("span",{directives:[{name:"t",rawName:"v-t",value:"admin.unverified",expression:"'admin.unverified'"}]}),e._v(" "),n("a",{attrs:{title:e.$t("admin.toggleVerification"),"data-test":"verification"},on:{click:function(n){return e.toggleVerification(t.row)}}},[n("i",{staticClass:"fas btn-edit",class:{"fa-toggle-on":t.row.verified,"fa-toggle-off":!t.row.verified},staticStyle:{"font-size":"18px"}})])]):"operations"===t.column.field?n("div",[n("el-button",{attrs:{size:"medium"},on:{click:function(n){return e.changePassword(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.changePassword"))+"\n        ")]),e._v(" "),n("el-button",{attrs:{disabled:t.row.permission>=2||1===t.row.operations&&t.row.permission>=1,type:"danger",size:"medium","data-test":"deleteUser"},on:{click:function(n){return e.deleteUser(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.deleteUser"))+"\n        ")])],1):n("span",{domProps:{textContent:e._s(t.formattedRow[t.column.field])}})]}}])})],1)},[],!1,null,null,null);t.default=m.exports},67:function(e,t,n){"use strict";var a=n(0),s=n(2);t.a=a.default.extend({mounted(){s.a("mounted",{el:this.$root.$options.el})}})},76:function(e,t,n){"use strict";var a=n(0);t.a=a.default.extend({data(){return{tableOptions:{search:{enabled:!0,placeholder:this.$t("vendor.datatable.search")},pagination:{enabled:!0,nextLabel:this.$t("vendor.datatable.next"),prevLabel:this.$t("vendor.datatable.prev"),rowsPerPageLabel:this.$t("vendor.datatable.rowsPerPage"),allLabel:this.$t("vendor.datatable.all"),ofLabel:this.$t("vendor.datatable.of")}}}}})}}]);
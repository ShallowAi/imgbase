(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{391:function(t,e,a){"use strict";a.r(e);var n=a(67);function o(t,e,a,n,o,i,s){try{var r=t[i](s),d=r.value}catch(t){return void a(t)}r.done?e(d):Promise.resolve(d).then(n,o)}function i(t){return function(){var e=this,a=arguments;return new Promise(function(n,i){var s=t.apply(e,a);function r(t){o(s,n,i,r,d,"next",t)}function d(t){o(s,n,i,r,d,"throw",t)}r(void 0)})}}var s={name:"UpdateButton",mixins:[n.a],data:()=>({canUpdate:blessing.extra.canUpdate,updating:!1,percentage:0}),methods:{update(){var t=this;return i(function*(){t.updating=!0,$("#modal-download").modal({backdrop:"static",keyboard:!1}),setTimeout(()=>t.polling(),500);const{code:e,message:a}=yield t.$http.post("/admin/update/download",{action:"download"});t.updating=!1,e?t.$alert(a,{type:"error"}):(yield t.$alert(t.$t("admin.updateCompleted"),{type:"success"}),window.location=blessing.base_url)})()},polling(){var t=this;return i(function*(){const e=yield t.$http.get("/admin/update/download",{action:"progress"});t.percentage=100*~~e,t.updating&&setTimeout(t.polling,500)})()}}},r=a(66),d=Object(r.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t.updating?a("el-button",{attrs:{disabled:"",type:"primary"}},[a("i",{staticClass:"fa fa-spinner fa-spin"}),t._v(" "+t._s(t.$t("admin.downloading"))+"\n  ")]):a("el-button",{attrs:{type:"primary",disabled:!t.canUpdate},on:{click:t.update}},[t._v(t._s(t.$t("admin.updateButton")))]),t._v(" "),a("div",{staticClass:"modal fade",attrs:{id:"modal-download",tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-dialog"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h4",{directives:[{name:"t",rawName:"v-t",value:"admin.downloading",expression:"'admin.downloading'"}],staticClass:"modal-title"})]),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"progress"},[a("div",{staticClass:"progress-bar progress-bar-striped active",style:{width:t.percentage+"%"},attrs:{role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"}},[a("span",[t._v(t._s(t.percentage))]),t._v("%\n            ")])])])])])])],1)},[],!1,null,null,null);e.default=d.exports},66:function(t,e,a){"use strict";function n(t,e,a,n,o,i,s,r){var d,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=a,l._compiled=!0),n&&(l.functional=!0),i&&(l._scopeId="data-v-"+i),s?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},l._ssrRegister=d):o&&(d=r?function(){o.call(this,this.$root.$options.shadowRoot)}:o),d)if(l.functional){l._injectStyles=d;var c=l.render;l.render=function(t,e){return d.call(e),c(t,e)}}else{var p=l.beforeCreate;l.beforeCreate=p?[].concat(p,d):[d]}return{exports:t,options:l}}a.d(e,"a",function(){return n})},67:function(t,e,a){"use strict";var n=a(0),o=a(2);e.a=n.default.extend({mounted(){o.a("mounted",{el:this.$root.$options.el})}})}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{105:function(e,t,a){"use strict";var n=a(0);t.a=n.default.extend({data:()=>({columns:[{field:"id"}],totalRecords:0,serverParams:{sortField:"id",sortType:"asc",page:1,perPage:10,search:""}}),created(){this.serverParams.sortField=this.columns[0].field},methods:{fetchData:()=>Promise.resolve(),onPageChange(e){this.serverParams.page=e.currentPage,this.fetchData()},onPerPageChange(e){this.serverParams.perPage=e.currentPerPage,this.fetchData()},onSortChange(e){let[t]=e;this.serverParams.sortType=t.type,this.serverParams.sortField=t.field,this.fetchData()},onSearch(e){this.serverParams.search=e.searchTerm,this.fetchData()}}})},394:function(e,t,a){"use strict";a.r(t);var n=a(90),r=(a(87),a(76)),s=a(105),i=a(67);function o(e,t,a,n,r,s,i){try{var o=e[s](i),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(n,r)}function l(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var s=e.apply(t,a);function i(e){o(s,n,r,i,l,"next",e)}function l(e){o(s,n,r,i,l,"throw",e)}i(void 0)})}}var d={name:"PlayersManagement",components:{VueGoodTable:n.a},mixins:[i.a,r.a,s.a],props:{baseUrl:{type:String,default:blessing.base_url}},data(){return{players:[],columns:[{field:"pid",label:"PID",type:"number"},{field:"name",label:this.$t("general.player.player-name")},{field:"uid",label:this.$t("general.player.owner"),type:"number"},{field:"preview",label:this.$t("general.player.previews"),globalSearchDisabled:!0,sortable:!1},{field:"last_modified",label:this.$t("general.player.last-modified")},{field:"operations",label:this.$t("admin.operationsTitle"),globalSearchDisabled:!0,sortable:!1}],textureChanges:{originalIndex:-1,type:"skin",tid:""}}},beforeMount(){this.fetchData()},methods:{fetchData(){var e=this;return l(function*(){const{data:t,totalRecords:a}=yield e.$http.get("/admin/player-data".concat(location.search),!location.search&&e.serverParams);e.totalRecords=a,e.players=t})()},changeTexture(){var e=this;return l(function*(){const t=e.players[e.textureChanges.originalIndex],{type:a,tid:n}=e.textureChanges,{code:r,message:s}=yield e.$http.post("/admin/players?action=texture",{pid:t.pid,type:a,tid:n});0===r?(t["tid_".concat(a)]=n,e.$message.success(s),$(".modal").modal("hide")):e.$message.warning(s)})()},changeName(e){var t=this;return l(function*(){let a;try{({value:a}=yield t.$prompt(t.$t("admin.changePlayerNameNotice"),{inputValue:e.name,inputValidator:e=>!!e||t.$t("admin.emptyPlayerName")}))}catch(e){return}const{code:n,message:r}=yield t.$http.post("/admin/players?action=name",{pid:e.pid,name:a});0===n?(e.name=a,t.$message.success(r)):t.$message.warning(r)})()},changeOwner(e){var t=this;return l(function*(){let a;try{({value:a}=yield t.$prompt(t.$t("admin.changePlayerOwner"),{inputValue:e.uid}))}catch(e){return}const{code:n,message:r}=yield t.$http.post("/admin/players?action=owner",{pid:e.pid,uid:a});0===n?(e.uid=a,t.$message.success(r)):t.$message.warning(r)})()},deletePlayer(e){var t=this;return l(function*(){let{pid:a,originalIndex:n}=e;try{yield t.$confirm(t.$t("admin.deletePlayerNotice"),{type:"warning"})}catch(e){return}const{code:r,message:s}=yield t.$http.post("/admin/players?action=delete",{pid:a});0===r?(t.$delete(t.players,n),t.$message.success(s)):t.$message.warning(s)})()}}},c=a(66),u=Object(c.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"content"},[a("vue-good-table",{attrs:{mode:"remote",rows:e.players,"total-rows":e.totalRecords||e.players.length,columns:e.columns,"search-options":e.tableOptions.search,"pagination-options":e.tableOptions.pagination,"style-class":"vgt-table striped"},on:{"on-page-change":e.onPageChange,"on-sort-change":e.onSortChange,"on-search":e.onSearch,"on-per-page-change":e.onPerPageChange},scopedSlots:e._u([{key:"table-row",fn:function(t){return["name"===t.column.field?a("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),a("a",{attrs:{title:e.$t("admin.changePlayerName"),"data-test":"name"},on:{click:function(a){return e.changeName(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"uid"===t.column.field?a("span",[a("a",{attrs:{href:e.baseUrl+"/admin/users?uid="+t.row.uid,title:e.$t("admin.inspectHisOwner"),"data-toggle":"tooltip","data-placement":"right"}},[e._v(e._s(t.formattedRow[t.column.field]))]),e._v(" "),a("a",{attrs:{title:e.$t("admin.changeOwner"),"data-test":"owner"},on:{click:function(a){return e.changeOwner(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"preview"===t.column.field?a("span",[t.row.tid_skin?a("a",{attrs:{href:e.baseUrl+"/skinlib/show/"+t.row.tid_skin}},[a("img",{attrs:{src:e.baseUrl+"/preview/64/"+t.row.tid_skin+".png",width:"64"}})]):e._e(),e._v(" "),t.row.tid_cape?a("a",{attrs:{href:e.baseUrl+"/skinlib/show/"+t.row.tid_cape}},[a("img",{attrs:{src:e.baseUrl+"/preview/64/"+t.row.tid_cape+".png",width:"64"}})]):e._e()]):"operations"===t.column.field?a("span",[a("el-button",{attrs:{"data-toggle":"modal","data-target":"#modal-change-texture",size:"medium"},on:{click:function(a){e.textureChanges.originalIndex=t.row.originalIndex}}},[e._v(e._s(e.$t("admin.changeTexture")))]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"medium"},on:{click:function(a){return e.deletePlayer(t.row)}}},[e._v(e._s(e.$t("admin.deletePlayer")))])],1):a("span",{domProps:{textContent:e._s(t.formattedRow[t.column.field])}})]}}])}),e._v(" "),a("div",{staticClass:"modal fade",attrs:{id:"modal-change-texture",tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-dialog"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[e._m(0),e._v(" "),a("h4",{directives:[{name:"t",rawName:"v-t",value:"admin.changeTexture",expression:"'admin.changeTexture'"}],staticClass:"modal-title"})]),e._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"form-group"},[a("label",{directives:[{name:"t",rawName:"v-t",value:"admin.textureType",expression:"'admin.textureType'"}]}),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.textureChanges.type,expression:"textureChanges.type"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.textureChanges,"type",t.target.multiple?a:a[0])}}},[a("option",{directives:[{name:"t",rawName:"v-t",value:"general.skin",expression:"'general.skin'"}],attrs:{value:"skin"}}),e._v(" "),a("option",{directives:[{name:"t",rawName:"v-t",value:"general.cape",expression:"'general.cape'"}],attrs:{value:"cape"}})])]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",[e._v("TID")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.textureChanges.tid,expression:"textureChanges.tid",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:e.$t("admin.pidNotice")},domProps:{value:e.textureChanges.tid},on:{input:function(t){t.target.composing||e.$set(e.textureChanges,"tid",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})])]),e._v(" "),a("div",{staticClass:"modal-footer"},[a("el-button",{attrs:{"data-dismiss":"modal"}},[e._v(e._s(e.$t("general.close")))]),e._v(" "),a("el-button",{attrs:{type:"primary","data-test":"changeTexture"},on:{click:e.changeTexture}},[e._v("\n            "+e._s(e.$t("general.submit"))+"\n          ")])],1)])])])],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[t("span",{attrs:{"aria-hidden":"true"}},[this._v("Ã—")])])}],!1,null,null,null);t.default=u.exports},67:function(e,t,a){"use strict";var n=a(0),r=a(2);t.a=n.default.extend({mounted(){r.a("mounted",{el:this.$root.$options.el})}})},76:function(e,t,a){"use strict";var n=a(0);t.a=n.default.extend({data(){return{tableOptions:{search:{enabled:!0,placeholder:this.$t("vendor.datatable.search")},pagination:{enabled:!0,nextLabel:this.$t("vendor.datatable.next"),prevLabel:this.$t("vendor.datatable.prev"),rowsPerPageLabel:this.$t("vendor.datatable.rowsPerPage"),allLabel:this.$t("vendor.datatable.all"),ofLabel:this.$t("vendor.datatable.of")}}}}})}}]);